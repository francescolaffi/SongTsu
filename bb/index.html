<!DOCTYPE html>

<!--
* Copyright 2010-2012 Research In Motion Limited.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
-->

<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta name="viewport" id="viewport" content="height=device-height,width=device-width,user-scalable=no" />
      <link type="text/css" rel="stylesheet" href="css/bbui-0.9.5.css" />
      <script type="text/javascript" src="js/bbui-0.9.5.js"></script>
      <script type="text/javascript" src="js/jquery-1.8.1.min.js"></script>
      <script type="text/javascript" src="js/app.js"></script>
      <script type="text/javascript" src="js/jsOauth.js"></script>
      <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>	  
      <style type="text/css">
         body {
            min-height: 500px;
              }
         .center {
            text-align: center;
            }
         h3 {
            color: #006A3C;
            }
         #map-canvas {
            height: 400px;
            }
      </style>
   </head>
   <body>
      <script type="text/javascript" src="local:///chrome/webworks.js"></script>
      <script type="text/javascript">
      /*global blackberry, bb */

      window.addEventListener('DOMContentLoaded', function () {
         document.addEventListener('webworksready', function () {
	    if (typeof bb !== 'undefined') {
	       bb.init({
                  // Fires "before" styling is applied and "before" the screen is inserted in the DOM
	          onscreenready: function (element, id, params) {
			         initApp();
//                     if ((blackberry.connection.type == "WIFI") || (blackberry.connection.type == "CELL_3G")) {
                        initParams();	  
//                        var audio = document.createElement('audio');
//                                       audio.src = "http://www.stereomood.com/listen/69857/Coriolis.mp3";
//                       audio.controls = true;
//						element.querySelector('#audio').appendChild(audio);
//						element.querySelector('#audio').visible = false;
                        CheckMood();						
//						}
			},
                            	
                  // Fires "after" styling is applied and "after" the screen is inserted in the DOM
		  ondomready: function (element, id) {
		     if (id === 'config') {
		        element.querySelector('#confBoth').addEventListener('click', function () {
			       bb.pushScreen('setupBoth.html', 'configBoth');
			    }, false);
		     } else if (id === 'menu') {
                                    //function doAlternateStuff() {
/*									   
                                       var startPos;
                                       navigator.geolocation.getCurrentPosition(
                                          function(position) {
                                             startPos = position;
                                             latitude = startPos.coords.latitude;
                                             longitude = startPos.coords.longitude;
											 maps.setCenter(startPos.coords);
											 marker.setPosition(startPos.coords);
											 if (rismet)
									            {
										        checkMeteo(startPos);
										        }
                                            },
                                          function(error) {
                                             switch(error.code) {
                                                case PositionError.PERMISSION_DENIED :
                                                   alert("Error. PERMISSION_DENIED");
                                                   break;
                                                case PositionError.POSITION_UNAVAILABLE:
                                                   alert("Error. POSITION_UNAVAILABLE");
                                                   break;
                                                case PositionError.TIMEOUT:
                                                   alert("Error. TIMEOUT");
                                                   break;
                                                default:
                                                   alert("unknow error code");
                                                }
                                            });
*/
										        
                                     //       };
//									   if ((rism) && (!rismet))
//                                       $.when(CheckMood()).then(function()
//									      {
	//								   if (typeof stitems[index] !== 'undefined' && stitems[index] !== null){
										// play default music

                                       //document.body.appendChild(audio);
                                          										  
//									});
								}
							}
						});
						/* Our default start page. */
						bb.pushScreen('menu.html', 'menu');
					}
				}, false);
			}, false);

            function initParams(){
 /*              if ((localStorage.getItem("meid") !== '') && (localStorage.getItem("mepwd") !== '')) var rismet = startMeTwitOAuth();
               else var rismet = false; */
			   var rismet = true;
 //              if ((localStorage.getItem("stid") !== '') && (localStorage.getItem("stipwd")!== '')) var rism = startStereoMoodOAuth();
 //              else var rism = false;
               var rism = true;
               if (localStorage.getItem("webip") !== '') {}
               else var webip = "";
            }		
		</script>
	</body>
</html>